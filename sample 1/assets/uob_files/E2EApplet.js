function des(b,c,d,e,g,f){var k=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],h=[-2146402272,-2147450880,
32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,
32800,-2147483648,-2146435040,-2146402272,1081344],l=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,
131592,8,134348808,131584],q=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],v=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,
1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],n=[536870928,541065216,
16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,
69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],s=[268439616,4096,262144,268701760,268435456,
268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];b=des_createKeys(b);var m=0,t,w,x,p,r,A,y,D,z,E,F,
G,B=c.length,C=0,H=32==b.length?3:9;A=3==H?d?[0,32,2]:[30,-2,-2]:d?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2];2==f?c+="        ":1==f?(f=8-B%8,c+=String.fromCharCode(f,f,f,f,f,f,f,f),8==f&&(B+=8)):f||(c+="\x00\x00\x00\x00\x00\x00\x00\x00");tempresult=result="";1==e&&(y=g.charCodeAt(m++)<<24|g.charCodeAt(m++)<<16|g.charCodeAt(m++)<<8|g.charCodeAt(m++),z=g.charCodeAt(m++)<<24|g.charCodeAt(m++)<<16|g.charCodeAt(m++)<<8|g.charCodeAt(m++),m=0);for(;m<B;){p=c.charCodeAt(m++)<<24|c.charCodeAt(m++)<<
16|c.charCodeAt(m++)<<8|c.charCodeAt(m++);r=c.charCodeAt(m++)<<24|c.charCodeAt(m++)<<16|c.charCodeAt(m++)<<8|c.charCodeAt(m++);1==e&&(d?(p^=y,r^=z):(D=y,E=z,y=p,z=r));f=(p>>>4^r)&252645135;r^=f;p^=f<<4;f=(p>>>16^r)&65535;r^=f;p^=f<<16;f=(r>>>2^p)&858993459;p^=f;r^=f<<2;f=(r>>>8^p)&16711935;p^=f;r^=f<<8;f=(p>>>1^r)&1431655765;r^=f;p^=f<<1;p=p<<1|p>>>31;r=r<<1|r>>>31;for(t=0;t<H;t+=3){F=A[t+1];G=A[t+2];for(g=A[t];g!=F;g+=G)w=r^b[g],x=(r>>>4|r<<28)^b[g+1],f=p,p=r,r=f^(h[w>>>24&63]|q[w>>>16&63]|n[w>>>
8&63]|s[w&63]|k[x>>>24&63]|l[x>>>16&63]|v[x>>>8&63]|u[x&63]);f=p;p=r;r=f}p=p>>>1|p<<31;r=r>>>1|r<<31;f=(p>>>1^r)&1431655765;r^=f;p^=f<<1;f=(r>>>8^p)&16711935;p^=f;r^=f<<8;f=(r>>>2^p)&858993459;p^=f;r^=f<<2;f=(p>>>16^r)&65535;r^=f;p^=f<<16;f=(p>>>4^r)&252645135;r^=f;p^=f<<4;1==e&&(d?(y=p,z=r):(p^=D,r^=E));tempresult+=String.fromCharCode(p>>>24,p>>>16&255,p>>>8&255,p&255,r>>>24,r>>>16&255,r>>>8&255,r&255);C+=8;512==C&&(result+=tempresult,tempresult="",C=0)}return result+tempresult}
function des_createKeys(b){pc2bytes0=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964];pc2bytes1=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697];pc2bytes2=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272];pc2bytes3=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,
139264,2236416,134356992,136454144];pc2bytes4=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256];pc2bytes5=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488];pc2bytes6=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746];pc2bytes7=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,
537069568];pc2bytes8=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578];pc2bytes9=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488];pc2bytes10=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800];pc2bytes11=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744];
pc2bytes12=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128];pc2bytes13=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261];for(var c=8<b.length?3:1,d=Array(32*c),e=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],g,f,k=0,h=0,l,q=0;q<c;q++)for(left=b.charCodeAt(k++)<<24|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<8|b.charCodeAt(k++),right=b.charCodeAt(k++)<<24|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<8|b.charCodeAt(k++),l=(left>>>4^right)&252645135,
right^=l,left^=l<<4,l=(right>>>-16^left)&65535,left^=l,right^=l<<-16,l=(left>>>2^right)&858993459,right^=l,left^=l<<2,l=(right>>>-16^left)&65535,left^=l,right^=l<<-16,l=(left>>>1^right)&1431655765,right^=l,left^=l<<1,l=(right>>>8^left)&16711935,left^=l,right^=l<<8,l=(left>>>1^right)&1431655765,right^=l,left^=l<<1,l=left<<8|right>>>20&240,left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240,right=l,i=0;i<e.length;i++)e[i]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=left<<1|
left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15,g=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],f=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15],l=(f>>>16^g)&65535,d[h++]=g^l,d[h++]=f^l<<16;return d}
function DES_EDE3KeyGenerator(){function b(b){if(c(b,0)||c(b,8)||c(b,24))return!0;var d=b.slice(0,8),e=b.slice(8,16);b=b.slice(16,24);return d.compare(e)||e.compare(b)||d.compare(b)?!0:!1}function c(b,c){for(var k=b.slice(c,c+8),h=d.concat(e),l=0;l<h.length;l++)if(k.compare(h[l]))return!0;return!1}this.generateKey=function(){var c="";do{for(var c=Array(24),d=(new Date).getSeconds(),e=0;24>e;e++)c[e]=Math.ceil(255*Math.random(d));for(d=0;d<c.length;d++){for(var e=0,h=7;0<h;h--)1==(c[d]>>>h&1)&&e++;
c[d]=0==e%2?c[d]&254|1:c[d]&254|0}}while(b(c));return c};var d=[[1,1,1,1,1,1,1,1],[31,31,31,31,14,14,14,14],[224,224,224,224,241,241,241,241],[254,254,254,254,254,254,254,254]],e=[[1,254,1,254,1,254,1,254],[31,224,31,224,14,241,14,241],[1,224,1,224,1,241,1,241],[31,254,31,254,14,254,14,254],[1,31,1,31,1,14,1,14],[224,254,224,254,241,254,241,254],[254,1,254,1,254,1,254,1],[224,31,224,31,241,14,241,14],[224,1,224,1,241,1,241,1],[254,31,254,31,254,14,254,14],[31,1,31,1,14,1,14,1],[254,224,254,224,254,
241,254,241]]}Array.prototype.compare=function(b){if(this.length!=b.length)return!1;for(var c=0;c<b.length;c++)if(this[c].compare&&!this[c].compare(b[c])||this[c]!==b[c])return!1;return!0};
function E2EApplet(){function b(){this.value=[]}function c(b,c,d){var e=b[c++],f=0,g;g=128==(b[c]&128)?!0:!1;if(g){g=b[c++]&127;for(var f=b.slice(c,c+g),u,s=0;s<f.length;s++)u|=(f[s]&255)<<8*s;f=u;c+=g}else f=b[c++];switch(e){case 3:if(0!=b[c++])throw"err";f-=1;case 48:return d.value=b.slice(c,c+f),null;case 2:return d.value=b.slice(c+f),b.slice(c,c+f);default:throw"err";}}var d=E2EApplet.ERR_INVALID_RSA_KEY,e="";this.addParameter=function(b,c){if(null!=c||""!=c)c=c.replace(/^\s+|\s+$/g,"");e=null==
e||""==e?e+(b+"%7D="+c):e+("%7B&"+b+"%7D="+c);return 0};var g="",f="";this.doFinal=function(k,h){try{var l=k,l=l.toUpperCase(),q=l.substr(l.search("06092A864886F70D010101")+22);if(-1==q.length)throw"err";if("0500"!=q.substring(0,4))throw"err";var v=Util.fromHexString(q.substr(4)),n=new b;if(null!=c(v,0,n))throw"err";if(null!=c(n.value,0,n))throw"err";g=Util.toHexString(c(n.value,0,n));if(null==g)throw"err";f=Util.toHexString(c(n.value,0,n));if(null==f)throw"err";}catch(u){throw d;}l=(new DES_EDE3KeyGenerator).generateKey();
q=Util.fromHexString(sha256Hash(e)).concat(Util.getByteArray(e));q=Util.cByteArrayToNString(q);v=String.fromCharCode(0,0,0,0,0,0,0,0);n=Util.cByteArrayToNString(l);q=Util.getByteArray(des(n,q,1,1,v,1));l=Util.getByteArray(h).concat(l);v=new RSAKey;v.setPublic(g,f);return v.encryptB(l).concat(Util.toHexString(q))}}E2EApplet.RSA_EXPONENT_3="3";E2EApplet.RSA_EXPONENT_65537="10001";E2EApplet.ERR_INVALID_RSA_KEY=42;var dbits,j_lm=!0;
function BigInteger(b,c,d){null!=b&&("number"==typeof b?this.fromNumber(b,c,d):null==c&&"string"!=typeof b?this.fromString(b,256):this.fromString(b,c))}function nbi(){return new BigInteger(null)}function am1(b,c,d,e,g,f){for(;0<=--f;){var k=c*this[b++]+d[e]+g;g=Math.floor(k/67108864);d[e++]=k&67108863}return g}
function am2(b,c,d,e,g,f){var k=c&32767;for(c>>=15;0<=--f;){var h=this[b]&32767,l=this[b++]>>15,q=c*h+l*k,h=k*h+((q&32767)<<15)+d[e]+(g&1073741823);g=(h>>>30)+(q>>>15)+c*l+(g>>>30);d[e++]=h&1073741823}return g}function am3(b,c,d,e,g,f){var k=c&16383;for(c>>=14;0<=--f;){var h=this[b]&16383,l=this[b++]>>14,q=c*h+l*k,h=k*h+((q&16383)<<14)+d[e]+g;g=(h>>28)+(q>>14)+c*l;d[e++]=h&268435455}return g}
"Nokia"==navigator.appName?(BigInteger.prototype.am=am3,dbits=28):j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):(BigInteger.prototype.am=am1,dbits=26);BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;rr=48;
for(vv=0;9>=vv;++vv)BI_RC[rr++]=vv;rr=97;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;rr=65;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(b){return BI_RM.charAt(b)}function intAt(b,c){var d=BI_RC[b.charCodeAt(c)];return null==d?-1:d}function bnpCopyTo(b){for(var c=this.t-1;0<=c;--c)b[c]=this[c];b.t=this.t;b.s=this.s}function bnpFromInt(b){this.t=1;this.s=0>b?-1:0;0<b?this[0]=b:-1>b?this[0]=b+DV:this.t=0}function nbv(b){var c=nbi();c.fromInt(b);return c}
function bnpFromString(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else if(4==c)d=2;else{this.fromRadix(b,c);return}this.s=this.t=0;for(var e=b.length,g=!1,f=0;0<=--e;){var k=8==d?b[e]&255:intAt(b,e);0>k?"-"==b.charAt(e)&&(g=!0):(g=!1,0==f?this[this.t++]=k:f+d>this.DB?(this[this.t-1]|=(k&(1<<this.DB-f)-1)<<f,this[this.t++]=k>>this.DB-f):this[this.t-1]|=k<<f,f+=d,f>=this.DB&&(f-=this.DB))}8==d&&0!=(b[0]&128)&&(this.s=-1,0<f&&(this[this.t-1]|=(1<<this.DB-
f)-1<<f));this.clamp();g&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var b=this.s&this.DM;0<this.t&&this[this.t-1]==b;)--this.t}
function bnToString(b){if(0>this.s)return"-"+this.negate().toString(b);var c;if(16==b)c=4;else if(8==b)c=3;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else return this.toRadix(b);var d=(1<<c)-1,e,g=!1,f="",k=this.t,h=this.DB-k*this.DB%c;if(0<k--)for(h<this.DB&&0<(e=this[k]>>h)&&(g=!0,f=int2char(e));0<=k;)h<c?(e=(this[k]&(1<<h)-1)<<c-h,e|=this[--k]>>(h+=this.DB-c)):(e=this[k]>>(h-=c)&d,0>=h&&(h+=this.DB,--k)),0<e&&(g=!0),g&&(f+=int2char(e));16==b&&0<f.length%2&&(f="0"+f);return g?f:"0"}
function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(b){var c=this.s-b.s;if(0!=c)return c;var d=this.t,c=d-b.t;if(0!=c)return c;for(;0<=--d;)if(0!=(c=this[d]-b[d]))return c;return 0}function nbits(b){var c=1,d;0!=(d=b>>>16)&&(b=d,c+=16);0!=(d=b>>8)&&(b=d,c+=8);0!=(d=b>>4)&&(b=d,c+=4);0!=(d=b>>2)&&(b=d,c+=2);0!=b>>1&&(c+=1);return c}function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}
function bnpDLShiftTo(b,c){var d;for(d=this.t-1;0<=d;--d)c[d+b]=this[d];for(d=b-1;0<=d;--d)c[d]=0;c.t=this.t+b;c.s=this.s}function bnpDRShiftTo(b,c){for(var d=b;d<this.t;++d)c[d-b]=this[d];c.t=Math.max(this.t-b,0);c.s=this.s}function bnpLShiftTo(b,c){var d=b%this.DB,e=this.DB-d,g=(1<<e)-1,f=Math.floor(b/this.DB),k=this.s<<d&this.DM,h;for(h=this.t-1;0<=h;--h)c[h+f+1]=this[h]>>e|k,k=(this[h]&g)<<d;for(h=f-1;0<=h;--h)c[h]=0;c[f]=k;c.t=this.t+f+1;c.s=this.s;c.clamp()}
function bnpRShiftTo(b,c){c.s=this.s;var d=Math.floor(b/this.DB);if(d>=this.t)c.t=0;else{var e=b%this.DB,g=this.DB-e,f=(1<<e)-1;c[0]=this[d]>>e;for(var k=d+1;k<this.t;++k)c[k-d-1]|=(this[k]&f)<<g,c[k-d]=this[k]>>e;0<e&&(c[this.t-d-1]|=(this.s&f)<<g);c.t=this.t-d;c.clamp()}}
function bnpSubTo(b,c){for(var d=0,e=0,g=Math.min(b.t,this.t);d<g;)e+=this[d]-b[d],c[d++]=e&this.DM,e>>=this.DB;if(b.t<this.t){for(e-=b.s;d<this.t;)e+=this[d],c[d++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;d<b.t;)e-=b[d],c[d++]=e&this.DM,e>>=this.DB;e-=b.s}c.s=0>e?-1:0;-1>e?c[d++]=this.DV+e:0<e&&(c[d++]=e);c.t=d;c.clamp()}
function bnpMultiplyTo(b,c){var d=this.abs(),e=b.abs(),g=d.t;for(c.t=g+e.t;0<=--g;)c[g]=0;for(g=0;g<e.t;++g)c[g+d.t]=d.am(0,e[g],c,g,0,d.t);c.s=0;c.clamp();this.s!=b.s&&BigInteger.ZERO.subTo(c,c)}function bnpSquareTo(b){for(var c=this.abs(),d=b.t=2*c.t;0<=--d;)b[d]=0;for(d=0;d<c.t-1;++d){var e=c.am(d,c[d],b,2*d,0,1);(b[d+c.t]+=c.am(d+1,2*c[d],b,2*d+1,e,c.t-d-1))>=c.DV&&(b[d+c.t]-=c.DV,b[d+c.t+1]=1)}0<b.t&&(b[b.t-1]+=c.am(d,c[d],b,2*d,0,1));b.s=0;b.clamp()}
function bnpDivRemTo(b,c,d){var e=b.abs();if(!(0>=e.t)){var g=this.abs();if(g.t<e.t)null!=c&&c.fromInt(0),null!=d&&this.copyTo(d);else{null==d&&(d=nbi());var f=nbi(),k=this.s;b=b.s;var h=this.DB-nbits(e[e.t-1]);0<h?(e.lShiftTo(h,f),g.lShiftTo(h,d)):(e.copyTo(f),g.copyTo(d));e=f.t;g=f[e-1];if(0!=g){var l=g*(1<<this.F1)+(1<e?f[e-2]>>this.F2:0),q=this.FV/l,l=(1<<this.F1)/l,v=1<<this.F2,n=d.t,u=n-e,s=null==c?nbi():c;f.dlShiftTo(u,s);0<=d.compareTo(s)&&(d[d.t++]=1,d.subTo(s,d));BigInteger.ONE.dlShiftTo(e,
s);for(s.subTo(f,f);f.t<e;)f[f.t++]=0;for(;0<=--u;){var m=d[--n]==g?this.DM:Math.floor(d[n]*q+(d[n-1]+v)*l);if((d[n]+=f.am(0,m,d,u,0,e))<m)for(f.dlShiftTo(u,s),d.subTo(s,d);d[n]<--m;)d.subTo(s,d)}null!=c&&(d.drShiftTo(e,c),k!=b&&BigInteger.ZERO.subTo(c,c));d.t=e;d.clamp();0<h&&d.rShiftTo(h,d);0>k&&BigInteger.ZERO.subTo(d,d)}}}}function Classic(b){this.m=b}function cConvert(b){return 0>b.s||0<=b.compareTo(this.m)?b.mod(this.m):b}function cRevert(b){return b}
function cReduce(b){b.divRemTo(this.m,null,b)}function cMulTo(b,c,d){b.multiplyTo(c,d);this.reduce(d)}function cSqrTo(b,c){b.squareTo(c);this.reduce(c)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;
function bnpInvDigit(){if(1>this.t)return 0;var b=this[0];if(0==(b&1))return 0;var c=b&3,c=c*(2-(b&15)*c)&15,c=c*(2-(b&255)*c)&255,c=c*(2-((b&65535)*c&65535))&65535,c=c*(2-b*c%this.DV)%this.DV;return 0<c?this.DV-c:-c}function Montgomery(b){this.m=b;this.mp=b.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<b.DB-15)-1;this.mt2=2*b.t}
function montConvert(b){var c=nbi();b.abs().dlShiftTo(this.m.t,c);c.divRemTo(this.m,null,c);0>b.s&&0<c.compareTo(BigInteger.ZERO)&&this.m.subTo(c,c);return c}function montRevert(b){var c=nbi();b.copyTo(c);this.reduce(c);return c}
function montReduce(b){for(;b.t<=this.mt2;)b[b.t++]=0;for(var c=0;c<this.m.t;++c){var d=b[c]&32767,e=d*this.mpl+((d*this.mph+(b[c]>>15)*this.mpl&this.um)<<15)&b.DM,d=c+this.m.t;for(b[d]+=this.m.am(0,e,b,c,0,this.m.t);b[d]>=b.DV;)b[d]-=b.DV,b[++d]++}b.clamp();b.drShiftTo(this.m.t,b);0<=b.compareTo(this.m)&&b.subTo(this.m,b)}function montSqrTo(b,c){b.squareTo(c);this.reduce(c)}function montMulTo(b,c,d){b.multiplyTo(c,d);this.reduce(d)}Montgomery.prototype.convert=montConvert;
Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?this[0]&1:this.s)}function bnpExp(b,c){var d=nbi(),e=nbi(),g=c.convert(this),f=nbits(b)-1;for(g.copyTo(d);0<=--f;)if(c.sqrTo(d,e),0<(b&1<<f))c.mulTo(e,g,d);else var k=d,d=e,e=k;return c.revert(d)}function bnModPowInt(b,c){var d;d=256>b||c.isEven()?new Classic(c):new Montgomery(c);return this.exp(b,d)}
function bnpToRadix(b){null==b&&(b=10);if(0==this.signum()||2>b||36<b)return"0";var c=this.chunkSize(b),c=Math.pow(b,c),d=nbv(c),e=nbi(),g=nbi(),f="";for(this.divRemTo(d,e,g);0<e.signum();)f=(c+g.intValue()).toString(b).substr(1)+f,e.divRemTo(d,e,g);return g.intValue().toString(b)+f}
function bnpBitwiseTo(b,c,d){var e,g,f=Math.min(b.t,this.t);for(e=0;e<f;++e)d[e]=c(this[e],b[e]);if(b.t<this.t){g=b.s&this.DM;for(e=f;e<this.t;++e)d[e]=c(this[e],g);d.t=this.t}else{g=this.s&this.DM;for(e=f;e<b.t;++e)d[e]=c(g,b[e]);d.t=b.t}d.s=c(this.s,b.s);d.clamp()}function op_xor(b,c){return b^c}function bnXor(b){var c=nbi();this.bitwiseTo(b,op_xor,c);return c}
function lbit(b){if(0==b)return-1;var c=0;0==(b&65535)&&(b>>=16,c+=16);0==(b&255)&&(b>>=8,c+=8);0==(b&15)&&(b>>=4,c+=4);0==(b&3)&&(b>>=2,c+=2);0==(b&1)&&++c;return c}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;
BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.toString=bnToString;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;
BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.prototype.xor=bnXor;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);
function OAEPEncodedMessage(b){function c(b,c,e){for(var f=Array(4),k=Math.ceil(e/g)-1,h=[],l=0;l<=k;l++){var n=l,q=f;q[0]=n>>>24;q[1]=n>>>16;q[2]=n>>>8;q[3]=n;h=h.concat(d(b.concat(f)))}OBMApplet.arraycopy(h,0,c,0,e)}function d(b){return Util.fromHexString(SHA1Hash(Util.cByteArrayToNString(b)))}function e(b){b=Array(b);for(var c,d,e=0;e<b.length;e++)c=Math.floor(16*Math.random()),d=Math.floor(16*Math.random()),b[e]=(c<<4)+d;return b}var g=20,f=OBMApplet.RSA_MODULUS_SIZE_IN_BYTES-42,k=OBMApplet.RSA_MODULUS_SIZE_IN_BYTES-
1,h=k-20,l=OAEPEncodedMessage.ERR_INVALID_PIN_MESSAGE,q=OAEPEncodedMessage.ERR_INVALID_PIN_MESSAGE_LENGTH,v,n;(function(b){var s=e(16),m=Array(f);if(null==b)throw{name:"OAEPEncodedMsgException",message:"Error no : "+l+" - Invalid PIN Message",code:l};var t=b.length();if(17>t||t>f)throw{name:"OAEPEncodedMsgException",message:"Error no : "+q+" Invalid PIN message length",code:q};b.getBytes(m);var w=d(s);b=Array(h);OBMApplet.fillByteArray(b,0);OBMApplet.arraycopy(w,0,b,0,20);w=20+(h-20-t-1);b[w]=1;w++;
OBMApplet.arraycopy(m,0,b,w,t);t=e(g);w=Array(h);c(t,w,h);m=Array(h);OBMApplet.xorByteArray(b,w,m);w=Array(g);c(m,w,g);b=Array(g);OBMApplet.xorByteArray(t,w,b);t=Array(k);OBMApplet.arraycopy(b,0,t,0,20);OBMApplet.arraycopy(m,0,t,20,h);v=t;n=Util.toHexString(s)})(b);this.getBytes=function(){return v};this.length=function(){return v.length};this.getEncodingParameter=function(){return n}}OAEPEncodedMessage.ERR_INVALID_PIN_MESSAGE=30;OAEPEncodedMessage.ERR_INVALID_PIN_MESSAGE_LENGTH=31;
function OBMApplet(){function b(b){if(0==h||null==k||null==f)throw{name:"EncryptedMessageException",message:"Error no : "+c+" Invalid RSA key",code:c};if(f.length/2!=h||k.length/2!=h)throw{name:"EncryptedMessageException",message:"Error no : "+e+" Invalid RSA key length",code:e};if(null==b)throw{name:"EncryptedMessageException",message:"Error no : "+d+" Invalid OAEP-encoded message length",code:d};if(b.length>h)throw{name:"EncryptedMessageException",message:"Error no : "+d+" input data too large for RSA encryption",
code:d};}var c=OBMApplet.ERR_INVALID_RSA_KEY,d=OBMApplet.ERR_INVALID_ENCODED_MSG_LENGTH,e=OBMApplet.ERR_INVALID_RSA_KEY_LENGTH,g=UOBApplet.ERR_OLD_NEW_PASSWORD_SAME,f=OBMApplet.PUBLIC_EXPONENT_STRING,k=OBMApplet.MODULUS_STRING,h=OBMApplet.RSA_MODULUS_SIZE_IN_BYTES,l="",q="",v=!1;if(0==h||null==k||null==f)throw{name:"OBMAppletException",message:"Error no : "+c+" Invalid RSA key",code:c};if(f.length/2!=h||k.length/2!=h)throw{name:"OBMAppletException",message:"Error no : "+e+" Invalid RSA key length",
code:e};v=!0;this.OBM_EncryptPassword=function(){if(2==arguments.length){var d=arguments[1];if(!v)throw{name:"OBMAppletException",message:"Error no : "+c+" Invalid RSA key",code:c};var e=new PINBlock(arguments[0]),d=new PINMessage(e,d),d=new OAEPEncodedMessage(d);b(d);q=d.getEncodingParameter();console.log("_P_String:"+q);d=[0].concat(d.getBytes());e=new RSAKey;e.setPublic(k,f);l=e.encryptNativeBytes(d);console.log("_C_String:"+l)}else if(3==arguments.length){var h=arguments[0],e=arguments[1],d=arguments[2];
if(!v)throw{name:"OBMAppletException",message:"Error no : "+c+" Invalid RSA key",code:c};if(h==e)throw{name:"OBMAppletException",message:"Error no : "+g+" New password is same as old password.",code:g};h=new PINBlock(h);e=new PINBlock(e);d=new PINMessage(h,e,d);d=new OAEPEncodedMessage(d);b(d);q=d.getEncodingParameter();d=[0].concat(d.getBytes());e=new RSAKey;e.setPublic(k,f);l=e.encryptNativeBytes(d)}};this.OBM_GetEncryptedPassword=function(){return l};this.OBM_GetEncodingParameter=function(){return q}}
OBMApplet.ERR_INVALID_RSA_KEY=42;OBMApplet.ERR_INVALID_ENCODED_MSG_LENGTH=40;OBMApplet.ERR_INVALID_RSA_KEY_LENGTH=41;OBMApplet.PUBLIC_EXPONENT_STRING="000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A1C3";OBMApplet.MODULUS_STRING="BB3DEFC03F8B0B2BEE2F62CE67691469EF96783D4B7788A1168D116B412833ECE1D44F0DA1EE66571C84C128E8BF6365151D5799193F11FA4FA6F7D0D2BD44AF2EB289DBAC477023389188FD9D88C91F69A5656FFD4853CF4D660134FE091E8D92E37DC6B2861F60BFF02D96042FD3A2A49F7C93C110BD534668A93905E40D23";
OBMApplet.RSA_MODULUS_SIZE_IN_BYTES=256;OBMApplet.fillByteArray=function(b,c){var d;for(d=0;d<b.length;d++)b[d]=c};OBMApplet.convertAsciiArrayToHexByteArray=function(b,c,d,e){var g,f,k,h;h=Math.ceil(e/2);for(k=f=0;f<h;f++)k<e-1?(g=(b[k]&15)<<4,g|=b[k+1]&15):(g=c[f+d]&15,g|=(b[k]&15)<<4),c[f+d]=g,k+=2};OBMApplet.arraycopy=function(b,c,d,e,g){for(g=Math.min(c+g,b.length);c<g;c++,e++)d[e]=b[c]};
OBMApplet.convertStringToPackedHexByteArray=function(b,c,d){for(var e=b.length,g=0,f=0;f<e;g++,f++){var k=b.charAt(f),k=parseInt(k,16);if(isNaN(k))return 1;var h=k<<4;if(++f<e){k=b.charAt(f);k=parseInt(k,16);if(isNaN(k))return 1;c[g+d]=h|k}else c[g+d]=h|15}return 0};OBMApplet.xorByteArray=function(b,c,d){for(var e=0;e<b.length;e++)d[e]=b[e]^c[e]};
function PINBlock(b){var c=PINBlock.ERR_INVALID_PIN_LENGTH,d=PINBlock.ERR_INVALID_PIN,e=PINBlock.ISO_FORMAT_2_TYPE,g=PINBlock.ISO_FORMAT_12_TYPE,f=UOBApplet.MAX_PIN_STRING_SIZE,k=UOBApplet.MIN_PIN_STRING_SIZE,h=[],l=0,q=0;this.getPINBlockType=function(){return l};this.getBytes=function(){return h};this.length=function(){return q};(function(b){var n=!1,u=!1,s=[],m=[];if(null==b||void 0==b)throw{name:"PINBlockException",message:"Error no : "+d+" - Invalid PIN String",code:d};var t=b.length;if(t>f||
t<k)throw{name:"PINBlockException",message:"Error no : "+c+" - Invalid PIN length",code:c};for(var w=0;w<t;w++){var x=b.charAt(w);if(!/^([a-zA-Z]|\d)$/.test(x)&&"_"!=x){u=!0;break}n&&(/^\d/.test(x)?m[w]=parseInt(x):n=!1);s[w]=x.charCodeAt(0)}if(u)throw{name:"PINBlockException",message:"Error no : "+d+" - Invalid PIN String",code:d};if(n)s=m.length,l=e,q=8,h=Array(8),OBMApplet.fillByteArray(h,255),h[0]=32|s&15,OBMApplet.convertAsciiArrayToHexByteArray(m,h,1,s);else for(m=s.length,l=g,b=4,b=6>=m?1:
Math.ceil((2+m)/8),q=8*b,h=Array(8*b),OBMApplet.fillByteArray(h,255),h[0]=193,h[1]=m,b=2,n=0;b<m+2;b++,n++)h[b]=s[n]})(b)}PINBlock.ERR_INVALID_PIN_LENGTH=10;PINBlock.ERR_INVALID_PIN=11;PINBlock.ISO_FORMAT_2_TYPE=1;PINBlock.ISO_FORMAT_12_TYPE=2;
function PINMessage(){function b(b,c){n=Array(q);s=g;n[0]=s;u=1;d(b);e(c)}function c(b,c,g){n=Array(q);s=f;n[0]=s;u=1;d(b);d(c);e(g)}function d(b){if(null==b)throw{name:"PINMessageException",message:"Error no : "+k+" - Invalid PIN Block",code:k};OBMApplet.arraycopy(b.getBytes(),0,n,u,b.length());u+=b.length()}function e(b){if(null==b)throw{name:"PINMessageException",message:"Error no : "+l+" - Invalid Random Number String",code:l};var c=b.length,d=Math.ceil(c/2),e=2*(q-u);if(c<v||c>e||c!=2*d)throw{name:"PINMessageException",
message:"Error no : "+h+" - Invalid Random Number String length",code:h};if(0!=OBMApplet.convertStringToPackedHexByteArray(b,n,u))throw{name:"PINMessageException",message:"Error no :"+l+" - Invalid Random Number String",code:l};u+=d}var g=PINMessage.ONE_PIN_BLOCK_IN_MESSAGE,f=PINMessage.TWO_PIN_BLOCKS_IN_MESSAGE,k=PINMessage.ERR_INVALID_PIN_BLOCK,h=PINMessage.ERR_INVALID_RANDOM_NUMBER_LENGTH,l=PINMessage.ERR_INVALID_RANDOM_NUMBER,q=OBMApplet.RSA_MODULUS_SIZE_IN_BYTES-42,v=16,n,u,s;2==arguments.length?
b(arguments[0],arguments[1]):3==arguments.length&&c(arguments[0],arguments[1],arguments[2]);this.getBytes=function(b){OBMApplet.arraycopy(n,0,b,0,u)};this.length=function(){return u}}PINMessage.ONE_PIN_BLOCK_IN_MESSAGE=1;PINMessage.TWO_PIN_BLOCKS_IN_MESSAGE=2;PINMessage.ERR_INVALID_PIN_BLOCK=20;PINMessage.ERR_INVALID_RANDOM_NUMBER_LENGTH=21;PINMessage.ERR_INVALID_RANDOM_NUMBER=22;function parseBigInt(b,c){return new BigInteger(b,c)}
function pkcs1pad2B(b,c){var d=b.length;if(d>c-11)throw"104";d=randomBytes(c-d-3);d=[0,2].concat(d,[0],b);return new BigInteger(d)}function randomBytes(b){for(var c=[],d=0,d=0;d<b;d++)c[d]=Math.ceil(255*Math.random());return c}function RSAKey(){this.n=null;this.e=0;this.d=null}RSAKey.prototype.setPublic=function(b,c){null!=b&&null!=c&&0<b.length&&0<c.length?(this.n=parseBigInt(b,16),this.e=parseInt(c,16)):alert("Invalid RSA public key")};
RSAKey.prototype.doPublic=function(b){return b.modPowInt(this.e,this.n)};RSAKey.prototype.encryptNativeBytes=function(b){var c=this.n.bitLength()+7>>3;if(b.length>c)throw"104";b=new BigInteger(b);if(null==b)return null;b=this.doPublic(b);if(null==b)return null;b=b.toString(16);if(512<b.length)return null;if(512>b.length)for(c=0;c<512-b.length;c++)b="0"+b;return b};
RSAKey.prototype.encryptB=function(b){b=pkcs1pad2B(b,this.n.bitLength()+7>>3);if(null==b)return null;b=this.doPublic(b);if(null==b)return null;b=b.toString(16);if(512<b.length)return null;if(512>b.length)for(var c=0;c<512-b.length;c++)b="0"+b;return b};
function SHA1Hash(b){var c=[1518500249,1859775393,2400959708,3395469782];b+=String.fromCharCode(128);for(var d=Math.ceil((b.length/4+2)/16),e=Array(d),g=0;g<d;g++){e[g]=Array(16);for(var f=0;16>f;f++)e[g][f]=b.charCodeAt(64*g+4*f)<<24|b.charCodeAt(64*g+4*f+1)<<16|b.charCodeAt(64*g+4*f+2)<<8|b.charCodeAt(64*g+4*f+3)}e[d-1][14]=8*(b.length-1)/Math.pow(2,32);e[d-1][14]=Math.floor(e[d-1][14]);e[d-1][15]=8*(b.length-1)&4294967295;b=1732584193;for(var f=4023233417,k=2562383102,h=271733878,l=3285377520,
q=Array(80),v,n,u,s,m,g=0;g<d;g++){for(var t=0;16>t;t++)q[t]=e[g][t];for(t=16;80>t;t++)v=q[t-3]^q[t-8]^q[t-14]^q[t-16],q[t]=v<<1|v>>>31;v=b;n=f;u=k;s=h;m=l;for(t=0;80>t;t++){var w=Math.floor(t/20),x=v<<5|v>>>27,p;a:{switch(w){case 0:p=n&u^~n&s;break a;case 1:p=n^u^s;break a;case 2:p=n&u^n&s^u&s;break a;case 3:p=n^u^s;break a}p=void 0}w=x+p+m+c[w]+q[t]&4294967295;m=s;s=u;u=n<<30|n>>>2;n=v;v=w}b=b+v&4294967295;f=f+n&4294967295;k=k+u&4294967295;h=h+s&4294967295;l=l+m&4294967295}return b.toHexStr()+f.toHexStr()+
k.toHexStr()+h.toHexStr()+l.toHexStr()}Number.prototype.toHexStr=function(){for(var b="",c,d=7;0<=d;d--)c=this>>>4*d&15,b+=c.toString(16);return b};
function sha256Hash(b){var c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,
3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],d=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];b+=String.fromCharCode(128);for(var e=Math.ceil((b.length/4+2)/16),g=Array(e),f=0;f<e;f++){g[f]=Array(16);for(var k=0;16>k;k++)g[f][k]=b.charCodeAt(64*f+4*k)<<24|b.charCodeAt(64*f+4*k+1)<<16|b.charCodeAt(64*
f+4*k+2)<<8|b.charCodeAt(64*f+4*k+3)}g[e-1][14]=8*(b.length-1)/Math.pow(2,32);g[e-1][14]=Math.floor(g[e-1][14]);g[e-1][15]=8*(b.length-1)&4294967295;b=Array(64);for(var h,l,q,v,n,u,s,f=0;f<e;f++){for(var m=0;16>m;m++)b[m]=g[f][m];for(m=16;64>m;m++)b[m]=sigma1(b[m-2])+b[m-7]+sigma0(b[m-15])+b[m-16]&4294967295;k=d[0];h=d[1];l=d[2];q=d[3];v=d[4];n=d[5];u=d[6];s=d[7];for(m=0;64>m;m++){var t=s+Sigma1(v)+Ch(v,n,u)+c[m]+b[m],w=Sigma0(k)+Maj(k,h,l);s=u;u=n;n=v;v=q+t&4294967295;q=l;l=h;h=k;k=t+w&4294967295}d[0]=
d[0]+k&4294967295;d[1]=d[1]+h&4294967295;d[2]=d[2]+l&4294967295;d[3]=d[3]+q&4294967295;d[4]=d[4]+v&4294967295;d[5]=d[5]+n&4294967295;d[6]=d[6]+u&4294967295;d[7]=d[7]+s&4294967295}return d[0].toHexStr()+d[1].toHexStr()+d[2].toHexStr()+d[3].toHexStr()+d[4].toHexStr()+d[5].toHexStr()+d[6].toHexStr()+d[7].toHexStr()}function ROTR(b,c){return c>>>b|c<<32-b}function Sigma0(b){return ROTR(2,b)^ROTR(13,b)^ROTR(22,b)}function Sigma1(b){return ROTR(6,b)^ROTR(11,b)^ROTR(25,b)}
function sigma0(b){return ROTR(7,b)^ROTR(18,b)^b>>>3}function sigma1(b){return ROTR(17,b)^ROTR(19,b)^b>>>10}function Ch(b,c,d){return b&c^~b&d}function Maj(b,c,d){return b&c^b&d^c&d}Number.prototype.toHexStr=function(){for(var b="",c,d=7;0<=d;d--)c=this>>>4*d&15,b+=c.toString(16);return b};
function UOBApplet(){var b;this.OBM_SpecifyRSAPublicKey=function(c,d,e){OBMApplet.PUBLIC_EXPONENT_STRING=d;OBMApplet.MODULUS_STRING=e;OBMApplet.RSA_MODULUS_SIZE_IN_BYTES=c;try{b=new OBMApplet}catch(g){return g.code}return UOBApplet.ERR_NO_ERROR};this.OBM_EncryptPassword=function(c,d){try{b.OBM_EncryptPassword(c,d)}catch(e){return e.code}return UOBApplet.ERR_NO_ERROR};this.OBM_EncryptChangedPassword=function(c,d,e){try{b.OBM_EncryptPassword(c,d,e)}catch(g){return g.code}return UOBApplet.ERR_NO_ERROR};
this.OBM_GetEncryptedPassword=function(){return b.OBM_GetEncryptedPassword()};this.OBM_GetEncodingParameter=function(){return b.OBM_GetEncodingParameter()}}UOBApplet.ERR_NO_ERROR=0;UOBApplet.INVALID_PIN_LENGTH=10;UOBApplet.ERR_INVALID_PIN=11;UOBApplet.ERR_INVALID_PIN_BLOCK=20;UOBApplet.ERR_INVALID_RANDOM_NUMBER_LENGTH=21;UOBApplet.ERR_INVALID_RANDOM_NUMBER=22;UOBApplet.ERR_OLD_NEW_PASSWORD_SAME=23;UOBApplet.ERR_INVALID_PIN_MESSAGE=30;UOBApplet.ERR_INVALID_PIN_MESSAGE_LENGTH=31;
UOBApplet.ERR_INVALID_RSA_KEY_LENGTH=41;UOBApplet.ERR_INVALID_RSA_KEY=42;UOBApplet.MAX_PIN_STRING_SIZE=24;UOBApplet.MIN_PIN_STRING_SIZE=8;function Util(){}Util.toHexString=function(b){for(var c="",d=0;d<b.length;d++){var e;"number"==typeof b[d]?e=b[d].toString(16):"string"==typeof b[d]&&(e=b.charCodeAt(d).toString(16));1==e.length&&(e="0"+e);c+=e}return c};
Util.fromHexString=function(b){b=0==b.length%2?b:"0"+b;for(var c=b.length/2,d=[],e=0,g=0;e<c;e++,g++){var f=2*e;d[g]=parseInt("0x"+b.substring(f,f+2))}return d};Util.getByteArray=function(b){a=[];for(var c=0;c<b.length;c++)a[c]=b.charCodeAt(c);return a};Util.cByteArrayToNString=function(b){for(var c="",d=0;d<b.length;d++)c+=String.fromCharCode(b[d]);return c};
